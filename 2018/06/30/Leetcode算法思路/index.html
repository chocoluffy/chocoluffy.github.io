<!doctype html>




<html class="theme-next mist">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />



  <meta name="google-site-verification" content="O92Q-a9Vf5dWXDW5Df-7NMxOta1TkJyuJddQxTM-n4U" />




  <meta name="baidu-site-verification" content="4TeaTL6Cbs" />







  
  
    
  
  <link href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.5/jquery.fancybox.css" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






  

<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.4.0/css/font-awesome.min.css" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.0.1" rel="stylesheet" type="text/css" />


  <link rel="amphtml" href="./amp/index.html">



  <meta name="keywords" content="算法,leetcode,interview,C++," />





  <link rel="alternate" href="/atom.xml" title="余舜哲的 One Piece" type="application/atom+xml" />




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.png?v=5.0.1" />






<meta name="description" content="My Leetcode solution analysis.">
<meta name="keywords" content="算法,leetcode,interview,C++">
<meta property="og:type" content="article">
<meta property="og:title" content="Leetcode常用数据结构和算法总结(python实现)">
<meta property="og:url" content="http://chocoluffy.com/2018/06/30/Leetcode算法思路/index.html">
<meta property="og:site_name" content="余舜哲的 One Piece">
<meta property="og:description" content="My Leetcode solution analysis.">
<meta property="og:locale" content="zh-Hans">
<meta property="og:updated_time" content="2021-01-01T14:20:59.600Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Leetcode常用数据结构和算法总结(python实现)">
<meta name="twitter:description" content="My Leetcode solution analysis.">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Mist',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: false,
    duoshuo: {
      userId: 10766069,
      author: '博主'
    }
  };
</script>

  <title> Leetcode常用数据结构和算法总结(python实现) | 余舜哲的 One Piece </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  


<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', '66874854-1', 'auto');
  ga('send', 'pageview');
</script>




  <script type="text/javascript">
    (function() {
      var hm = document.createElement("script");
      hm.src = "//tajs.qq.com/stats?sId=56472517";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>






  
  
    
  

  <div class="container one-collumn sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">余舜哲的 One Piece</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle"></p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-tech">
          <a href="/tech" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-battery-full"></i> <br />
            
            技术
          </a>
        </li>
      
        
        <li class="menu-item menu-item-life">
          <a href="/life" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-book"></i> <br />
            
            随笔
          </a>
        </li>
      
        
        <li class="menu-item menu-item-books">
          <a href="/books" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-bookmark"></i> <br />
            
            书房
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="#" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup">
 <span class="search-icon fa fa-search"></span>
 <input type="text" id="local-search-input">
 <div id="local-search-result"></div>
 <span class="popup-btn-close">close</span>
</div>


    </div>
  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                Leetcode常用数据结构和算法总结(python实现)
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2018-06-30T10:32:06-04:00" content="2018-06-30">
              2018-06-30
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/技术/" itemprop="url" rel="index">
                    <span itemprop="name">技术</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2018/06/30/Leetcode算法思路/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2018/06/30/Leetcode算法思路/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          
             <span id="/2018/06/30/Leetcode算法思路/" class="leancloud_visitors" data-flag-title="Leetcode常用数据结构和算法总结(python实现)">
               &nbsp; | &nbsp;
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">阅读次数 </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          

          
          <span>
            &nbsp; | &nbsp;
            <span class="post-meta-item-icon">
              <i class="fa fa-clock-o"></i>
            </span>
            <span class="post-meta-item-text">阅读时长</span>
            <span class="post-count">11 分钟</span>
          </span>
          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <h1 id="Data_Structure">Data Structure</h1><h3 id="stack">stack</h3><p>单调栈的使用：</p>
<ul>
<li>找到每个元素下一个更大的元素。</li>
</ul>
<h3 id="palindrome">palindrome</h3><p>很多时候和prefix，suffix联系在一起。</p>
<h3 id="trie">trie</h3><p>和hash相比在存储string的时候的一些好处：</p>
<ul>
<li>找到所有具有common prefix的keys</li>
<li>以字典顺序遍历所有string的时候</li>
<li>当hash不断增大的时候，会出现很多hash collitions，对于trie来说当大部分的字符串具有类似prefix的时候，效率比较高。<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># trie的具体python实现.</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Trie</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.end = <span class="keyword">False</span> <span class="comment"># 需要这个属性来mark一下，是否到这个node为止组成的这个word存在！！比如insert('apple')之后，'app'最后'p'这个点的end应该是False的。</span></span><br><span class="line">        self.c = &#123;&#125; <span class="comment"># 利用recursion的想法，每个当前的children node都为一个Trie tree. key: char, val: new Trie().</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">insert</span><span class="params">(self, word)</span>:</span></span><br><span class="line">        node = self</span><br><span class="line">        <span class="keyword">for</span> w <span class="keyword">in</span> word:</span><br><span class="line">            <span class="keyword">if</span> w <span class="keyword">not</span> <span class="keyword">in</span> node.c:</span><br><span class="line">                node.c[w] = Trie()</span><br><span class="line">            node = node.c[w]</span><br><span class="line">        node.end = <span class="keyword">True</span></span><br><span class="line">            </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">prefixnode</span><span class="params">(self,word)</span>:</span></span><br><span class="line">        node = self</span><br><span class="line">        <span class="keyword">for</span> w <span class="keyword">in</span> word:</span><br><span class="line">            <span class="keyword">if</span> w <span class="keyword">not</span> <span class="keyword">in</span> node.c:</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">None</span></span><br><span class="line">            node = node.c[w]</span><br><span class="line">        <span class="keyword">return</span> node</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">search</span><span class="params">(self, word)</span>:</span></span><br><span class="line">        node = self.prefixnode(word)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> node:</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">False</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">True</span> <span class="keyword">if</span> node.end <span class="keyword">else</span> <span class="keyword">False</span></span><br><span class="line">            </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">startsWith</span><span class="params">(self, prefix)</span>:</span></span><br><span class="line">        node = self.prefixnode(prefix)       </span><br><span class="line">        <span class="keyword">return</span> bool(node)</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="sliding_window">sliding window</h3><ul>
<li>two pointer sliding window</li>
</ul>
<p>右指针先expand直到满足条件，然后左指针move直到break条件，常适用于找到最小区间。</p>
<ul>
<li>mono deque(double ended queue)</li>
</ul>
<p>pop直到结构内元素单调然后push。</p>
<h1 id="Algorithm">Algorithm</h1><h3 id="union_find">union find</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">最简单的版本</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="comment"># a parent array of N, record each position's root parent index. </span></span><br><span class="line"><span class="comment"># if two points's root equals, then they are in same group.</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">find</span><span class="params">(parent, idx)</span>:</span></span><br><span class="line">	<span class="keyword">if</span> parent[idx] == <span class="number">-1</span>:</span><br><span class="line">    	<span class="keyword">return</span> idx</span><br><span class="line">    <span class="keyword">return</span> find(parent, parent[idx])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 最简单的版本</span></span><br><span class="line"><span class="comment"># mark these two points as from same parent, by finding each one's and compare.</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">union</span><span class="params">(parent, x, y)</span>:</span></span><br><span class="line">	root_x = find(parent, x)</span><br><span class="line">    root_y = find(parent, y)</span><br><span class="line">    <span class="keyword">if</span> root_x != root_y:</span><br><span class="line">    	parent[x] = root_y</span><br><span class="line">        </span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">优化后的版本</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Node</span><span class="params">(object)</span>:</span></span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></span><br><span class="line">    	self.parent = <span class="number">0</span> <span class="comment"># record parent node's index.</span></span><br><span class="line">        self.rank = <span class="number">0</span> <span class="comment"># record current tree's rank, rooted at current node.</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 路径压缩版本：path-compression version.</span></span><br><span class="line"><span class="comment"># 每一次find的时候，都把自己的parent设为当前找到的parent。来避免worst case: O(n) 的 find time complexity。</span></span><br><span class="line"><span class="comment"># 设置parent[0] = 0 为总的根, 于是所有level为1的点，parent值都为0。</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">find</span><span class="params">(parent, idx)</span>:</span></span><br><span class="line">	<span class="keyword">while</span> parent[idx] != idx:</span><br><span class="line">    	parent[idx] = find(parent, parent[idx])</span><br><span class="line">    <span class="keyword">return</span> parent[idx]</span><br><span class="line">    </span><br><span class="line"><span class="comment"># 最小树版本。</span></span><br><span class="line"><span class="comment"># 避免在随意合并的时候形成的worst case: O(n)的linked list形状，best case：balanced tree. </span></span><br><span class="line"><span class="comment"># 让小rank的树append到大rank的树下，也就是设置小rank的parent</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">union</span><span class="params">(parent, x, y)</span>:</span></span><br><span class="line">	root_x = find(parent, x)</span><br><span class="line">    root_y = find(parent, y)</span><br><span class="line">    <span class="keyword">if</span> root_x &gt; root_y:</span><br><span class="line">    	parent[y] = root_x</span><br><span class="line">    <span class="keyword">elif</span> root_x &lt; root_y:</span><br><span class="line">    	parent[x] = root_y</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">    	parent[x] = root_y</span><br><span class="line">        root_y.rank += <span class="number">1</span></span><br></pre></td></tr></table></figure>
<p>在优化之后，查找find的first time worst case：O(logn)， 因为有path compression，之后所有的find操作都为常数，因此 amortized time complexity为O(1)。如果没有优化，worst case: O(n)。</p>
<h3 id="partition_algorithm(in_quicksort)">partition algorithm(in quicksort)</h3><p>保持数组部分有序的方式，找到一个pivot，根据这个pivot对这个数组重新arrange之后保证pivot左边数字都比它小，而右边数字都比它大。T：O(n), S: O(1)。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># two pointers, i and j, such that every elements at left of i are smaller than pivot, which gives that the elements between i and j are larger than the pivot. and finally swap the pivot with the index i position to yield the correct partition.</span></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line">j = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> j &lt; len(s): <span class="comment"># use j to iterate throught the array.</span></span><br><span class="line">	<span class="keyword">if</span> s[j] &lt; pivot: <span class="comment"># swap with index i, </span></span><br><span class="line">    	swap(i, j)</span><br><span class="line">        i++</span><br><span class="line">        j++</span><br><span class="line">    <span class="keyword">elif</span> s[j] &gt; pivot:</span><br><span class="line">    	j++</span><br><span class="line">swap(i, pivot_index)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Extension: 当存在和pivot值相同的元素的时候，如果需要将其置于中间，需要three pointers，多引入一个pointer k指向数组的最后，然后每当有元素大于pivot的时候，和k位置交换元素，同样利用j来遍历数组，保证小于i位置的都比pivot小，大于k位置的都比pivot大。</span></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line">j = <span class="number">0</span></span><br><span class="line">k = len(s) - <span class="number">1</span></span><br><span class="line"><span class="keyword">while</span> j &lt; len(s): <span class="comment"># use j to iterate throught the array.</span></span><br><span class="line">	<span class="keyword">if</span> s[j] &lt; pivot: <span class="comment"># swap with index i, </span></span><br><span class="line">    	swap(i, j)</span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line">        j += <span class="number">1</span></span><br><span class="line">    <span class="keyword">elif</span> s[j] &gt; pivot:</span><br><span class="line">    	swap(j, k)</span><br><span class="line">        k -= <span class="number">1</span></span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">    	j += <span class="number">1</span></span><br></pre></td></tr></table></figure></p>
<h3 id="KMP_string_pattern_matching">KMP string pattern matching</h3><p>本质是找：针对一个string的最长prefix\suffix匹配。基于这个table，在pattern match的时候，当遇到部分匹配的情况时，我们可以利用match这部分的longest prefix\suffix match直接从suffix的位置继续开始匹配，而省略了其中的一部分匹配过程。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># construct the lookup table, f(i) records that up till position i, the length of the longest prefix\suffix match.</span></span><br><span class="line">f(<span class="number">0</span>) = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">1</span>; i &lt; n; i++)</span><br><span class="line">&#123;</span><br><span class="line">    t = f(i<span class="number">-1</span>)</span><br><span class="line">    <span class="keyword">while</span>(t &gt; <span class="number">0</span> &amp;&amp; b[i] != b[t])</span><br><span class="line">        t = f(t<span class="number">-1</span>)</span><br><span class="line">    <span class="keyword">if</span>(b[i] == b[t])&#123;</span><br><span class="line">        ++t</span><br><span class="line">    f(i) = t</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="Graph">Graph</h3><p>关于图像遍历的算法常见技巧：</p>
<ul>
<li>直接修改graph二维数组来做visited的作用，而不需要新建一个等大小的数组增加内存开销，尤其对于recursion影响大。</li>
</ul>
<h3 id="BFS">BFS</h3><p>算法重心在于level的累加，是当queue中来自上一层的所有node都pop出来之后，level += 1。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> deque</span><br><span class="line">queue = []</span><br><span class="line">queue.append(source)</span><br><span class="line">level = <span class="number">0</span></span><br><span class="line">directions = [[<span class="number">0</span>, <span class="number">1</span>], [<span class="number">1</span>, <span class="number">0</span>], [<span class="number">0</span>, <span class="number">-1</span>], [<span class="number">-1</span>, <span class="number">0</span>]]</span><br><span class="line"><span class="keyword">while</span> len(queue) &gt; <span class="number">0</span>:</span><br><span class="line">	level += <span class="number">1</span></span><br><span class="line">    size = len(queue)</span><br><span class="line">    <span class="keyword">while</span> size &gt; <span class="number">0</span>:</span><br><span class="line">    	size -= <span class="number">1</span></span><br><span class="line">        curr = queue.popleft()</span><br><span class="line">        <span class="keyword">for</span> dx, dy <span class="keyword">in</span> directions:</span><br><span class="line">        	newx, newy = curr[<span class="number">0</span>] + dx, curr[<span class="number">1</span>] + dy</span><br><span class="line">            <span class="keyword">if</span> new_position_valid():</span><br><span class="line">            	grid[newx][newy] = <span class="number">0</span> <span class="comment"># mark visited.</span></span><br><span class="line">                check_if_meet_final_target() <span class="comment"># return level-related number.</span></span><br><span class="line">                queue.append(newx, newy)</span><br></pre></td></tr></table></figure></p>
<h3 id="find_majority_element">find majority element</h3><p>Q: there is one majority element in the array, it appear more than n/2 times. </p>
<p>solutions:</p>
<ul>
<li><p>binary search tree with counting.<br>insert the node into binary search tree, if such leaf already exists, increase the value of that node till one exceeds n/2. for a balanced binary tree, T: O(nlogn), S: O(n), need extra n space for creating binary tree.</p>
</li>
<li><p>moore voting(find_candidate + validate)<br>validate的时间是O(n)。使用类似semaphore的想法。利用一个counter，如果相邻的连续是相同的就counter++，如果不同就清零更换一个character。</p>
</li>
</ul>
<h3 id="product_puzzle_without_division_in_O(n)">product puzzle without division in O(n)</h3><p>Q: given an array of element, return another array of same size, where each element is the product of all element except for itself. you cannot use division. do this in O(n) time.</p>
<ul>
<li>构建左右累计数列。<br>一个很实用的技巧，当这个位置和其他所有位置的信息相关的时候，或者，如果naive的做法是基于每个点从中往外扩开的情况的话，可以考虑这个方向。也即，从左一次做累计操作，O(n)，同理从右也一遍。在本题中则是构建累乘数列，<code>L[i] = L[i- 1] * A[i - 1]</code>, <code>R[i - 1] = R[i] * A[i], i = n - 1, i--</code>. 则<code>prod = L[i] * R[i]</code></li>
</ul>
<h3 id="subarray\substring_matching_by_hashing">subarray\substring matching by hashing</h3><p>应用比如 plagiarism。<br>构建一种算法，使得计算hash value的阶段可以累加，也就是说对于一串字符串来说，不需要每次在插入字符或者删除字符的时候对所有字符编码O(n)，而只需要O(1)的复杂度来更新hash value：<br>找到一个base，<code>next = (prev * base + new_char) % large_prime</code>，类比构建正数分位。</p>
<h1 id="General_Tricks">General Tricks</h1><ul>
<li><p>在python里，当在循环里面需要匹配多个字符的时候，往往需要考虑边界问题，尤其是在循环停止之后漏掉的字符，这个时候多用slicing operation: <code>s[:i+1]</code>而不是直接用index ref这种： <code>s[i+1]</code>，因为slicing operation可以避免index overflow的问题。</p>
</li>
<li><p>大数相加、相乘时注意overflow的问题，在cpp和java里会出现，在python里不会。</p>
</li>
<li><p>XOR可以用来辅助（A XOR A = 0; A XOR 0 = A）</p>
<ul>
<li>even\odd apperance.</li>
<li>find missing number.</li>
<li>find duplicate.</li>
</ul>
</li>
<li><p>merge sort. 可以记录大小元素的先后顺序。可用于count inversions。</p>
</li>
<li><p>quick sort. 核心在于partition，剩下的就是divide and conquer，在partition的时候，重点在O(n)的时间内，选取一个pivot，同时将所有比pivot点小的点移动到pivot左侧，比pivot点大的点移到右侧。本质上看，这个O(n)的操作，可以找到第n-index(pivot)大的元素也即pivot。可用于find k largest elements。</p>
</li>
<li><p>space complexity优化的技巧。看每一次独立的遍历中依赖的变量数量。通常在dp问题里面会遇到。简单的情况是依赖于前一个或者前两个（fibonacci数列）的subproblems的答案，那么其实所需要的空间就为依赖的变量数即可，大部分dp都涉及构建一个两维的dp table，但如果每一次独立循环中问题只涉及本行和前一行的subproblems的答案，空间通常可以优化为max(row_size, column_size)，只需要每次不断地更新那一列即可。</p>
</li>
<li><p><code>y = x &amp; !(x - 1)</code> will get the rightmost set bit of x. 因为(x - 1)的作用其实是反转所有rightmost set bit以右的bits。</p>
</li>
<li><p>BST可以拓展来用于interval, number of elements in range。</p>
</li>
<li><p>关于heap和BST的区别：</p>
<ul>
<li>误区：heap的find max\min为O(1)，比BST更好。但其实我们可以用extra variable来拿BST的max\min从而达到同样的效果</li>
<li>因为heap从底部插入数据，而bst是从顶部插入数据。所以heap的insert的amortized time complexity是O(1)因为最底层占了一半以上的数据。</li>
</ul>
</li>
<li><p>function stack也算作time complexity里。</p>
</li>
<li><p>BST很多时候可以和divide and conquer\DP联系在一起。因为本质上每一个root都可以将range分为两个独立的range（subproblem）。结合具体问题进一步完整recursion或者dp table。</p>
</li>
<li><p>关于permutation&amp;combination（排列组合），当选取的相同元素之间的排序不重要的时候，用组合combination, <code>C_(m+n)^(n) = (m+n)!/m!*n!</code>，当选取的相同元素之间的顺序也算的时候，用排列<code>A_(m+n)^(n) = (m+n)!/m!</code></p>
</li>
</ul>

      
    </div>

    <div>
      
        
      
    </div>

    <div>
      
        
  <div style="padding: 10px 0; margin: 20px auto; width: 90%; text-align: center;">
    <div>一起加油！</div>
    <button id="rewardButton" disable="enable" onclick="var qr = document.getElementById('QR'); if (qr.style.display === 'none') {qr.style.display='block';} else {qr.style.display='none'}">
      <span>赏</span>
    </button>
    <div id="QR" style="display: none;">
      
        <div id="wechat" style="display: inline-block">
          <img id="wechat_qr" src="/images/wechatpay.png" alt="余舜哲 WeChat Pay"/>
          <p>微信打赏</p>
        </div>
      
      
    </div>
  </div>


      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/算法/" rel="tag"><i class="fa fa-tag" > </i>
算法</a>
          
            <a href="/tags/leetcode/" rel="tag"><i class="fa fa-tag" > </i>
leetcode</a>
          
            <a href="/tags/interview/" rel="tag"><i class="fa fa-tag" > </i>
interview</a>
          
            <a href="/tags/C/" rel="tag"><i class="fa fa-tag" > </i>
C++</a>
          
        </div>
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2018/06/29/《加缪手记第二卷》阅读批注/" rel="next" title="《加缪手记第二卷》阅读批注">
                <i class="fa fa-chevron-left"></i> 《加缪手记第二卷》阅读批注
              </a>
            
          </div>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2018/07/01/Leetcode题目解析/" rel="prev" title="Leetcode题目解析">
                Leetcode题目解析 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      

      
        <h3> 相关文章：</h3><ul class="related-posts"><li><a href="/2018/07/01/Leetcode题目解析/">Leetcode题目解析</a></li><li><a href="/2018/07/26/写在微软Imageine-Cup决赛圈之后/">写在微软Imagine Cup决赛圈之后</a></li><li><a href="/2018/10/05/对李开复新书演讲《AI·未来》的一点思考/">对李开复新书演讲《AI·未来》的一点思考</a></li><li><a href="/2016/12/04/浅析经典面试算法题-two-pointer的运用/">浅析经典面试算法题-two pointer的运用</a></li></ul>
      

      <div class="addthis_inline_share_toolbox" 
           style="
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: -25px;
            margin-top: 30px;
           "
      ></div>            

    </footer>
  </article>



    <div class="post-spread">
      
        <!-- Go to www.addthis.com/dashboard to customize your tools -->
<script type = "text/javascript" src = "//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5c1469ab13400612" async = "async" ></script>
      
    </div>
  </div>


          </div>
          
  <div class="comments" id="comments">
    
      <div id="disqus_thread">
        <noscript>
          Please enable JavaScript to view the
          <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a>
        </noscript>
      </div>
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-overlay"></div>
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="https://raw.githubusercontent.com/chocoluffy/blog_assets/master/me.jpg"
               alt="余舜哲" />
          <p class="site-author-name" itemprop="name">余舜哲</p>
          <p class="site-description motion-element" itemprop="description">时间知道</p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">141</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          
            <div class="site-state-item site-state-categories">
              
                <span class="site-state-item-count">9</span>
                <span class="site-state-item-name">分类</span>
              
            </div>
          

          
            <div class="site-state-item site-state-tags">
              
                <span class="site-state-item-count">69</span>
                <span class="site-state-item-name">标签</span>
              
            </div>
          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/chocoluffy" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://weibo.com/chocoluffy" target="_blank" title="微博">
                  
                    <i class="fa fa-fw fa-weibo"></i>
                  
                  微博
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://www.douban.com/people/chocolufy/" target="_blank" title="豆瓣">
                  
                    <i class="fa fa-fw fa-book"></i>
                  
                  豆瓣
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://www.zhihu.com/people/yu-shun-zhe/" target="_blank" title="知乎">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  知乎
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://www.linkedin.com/in/yushunzhe/" target="_blank" title="Linkedin">
                  
                    <i class="fa fa-fw fa-linkedin-square"></i>
                  
                  Linkedin
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://chocoluffy.com/link/" target="_blank" title="友链">
                  
                    <i class="fa fa-fw fa-users"></i>
                  
                  友链
                </a>
              </span>
            
          
        </div>

        
        

        
        

      </section>

      
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">
            
              
            
            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Data_Structure"><span class="nav-number">1.</span> <span class="nav-text">Data Structure</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#stack"><span class="nav-number">1.0.1.</span> <span class="nav-text">stack</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#palindrome"><span class="nav-number">1.0.2.</span> <span class="nav-text">palindrome</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#trie"><span class="nav-number">1.0.3.</span> <span class="nav-text">trie</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#sliding_window"><span class="nav-number">1.0.4.</span> <span class="nav-text">sliding window</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Algorithm"><span class="nav-number">2.</span> <span class="nav-text">Algorithm</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#union_find"><span class="nav-number">2.0.1.</span> <span class="nav-text">union find</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#partition_algorithm(in_quicksort)"><span class="nav-number">2.0.2.</span> <span class="nav-text">partition algorithm(in quicksort)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#KMP_string_pattern_matching"><span class="nav-number">2.0.3.</span> <span class="nav-text">KMP string pattern matching</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Graph"><span class="nav-number">2.0.4.</span> <span class="nav-text">Graph</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#BFS"><span class="nav-number">2.0.5.</span> <span class="nav-text">BFS</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#find_majority_element"><span class="nav-number">2.0.6.</span> <span class="nav-text">find majority element</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#product_puzzle_without_division_in_O(n)"><span class="nav-number">2.0.7.</span> <span class="nav-text">product puzzle without division in O(n)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#subarray\substring_matching_by_hashing"><span class="nav-number">2.0.8.</span> <span class="nav-text">subarray\substring matching by hashing</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#General_Tricks"><span class="nav-number">3.</span> <span class="nav-text">General Tricks</span></a></li></ol></div>
            
          </div>
        </section>
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy;  2013 - 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">余舜哲</span>
  <span class="post-count"> | 博客全站共429.1k字</span>
</div>

        

<div class="busuanzi-count">

  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  

  
    <span class="site-pv">你是第<span class="busuanzi-value" id="busuanzi_value_site_pv"></span>个小伙伴</span>
  
  
</div>



        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>

  
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/fastclick/1.0.6/fastclick.min.js"></script>

  
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery_lazyload/1.9.7/jquery.lazyload.min.js"></script>

  
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/velocity/1.5.0/velocity.min.js"></script>

  
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/velocity/1.3.1/velocity.ui.min.js"></script>

  
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.5/jquery.fancybox.pack.js"></script>



  <script src="//instant.page/1.0.0" type="module" integrity="sha384-6w2SekMzCkuMQ9sEbq0cLviD/yR2HfA/+ekmKiBnFlsoSvb/VmQFSi/umVShadQI"></script>

  


  <script type="text/javascript" src="/js/src/utils.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.0.1"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.0.1"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.0.1"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.0.1"></script>



  



  

    <script type="text/javascript">
      var disqus_shortname = 'chocoluffy';
      var disqus_identifier = '2018/06/30/Leetcode算法思路/';
      var disqus_title = 'Leetcode常用数据结构和算法总结(python实现)';
      var disqus_url = 'http://chocoluffy.com/2018/06/30/Leetcode算法思路/';

      function run_disqus_script(disqus_script){
        var dsq = document.createElement('script');
        dsq.type = 'text/javascript';
        dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      }

      run_disqus_script('count.js');
      
        run_disqus_script('embed.js');
      
    </script>
  



  
  
  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length == 0) {
       search_path = "search.xml";
    }
    var path = "/" + search_path;
    // monitor main search box;

    function proceedsearch() {
      $("body").append('<div class="popoverlay">').css('overflow', 'hidden');
      $('.popup').toggle();

    }
    // search function;
    var searchFunc = function(path, search_id, content_id) {
    'use strict';
    $.ajax({
        url: path,
        dataType: "xml",
        async: true,
        success: function( xmlResponse ) {
            // get the contents from search data
            isfetched = true;
            $('.popup').detach().appendTo('.header-inner');
            var datas = $( "entry", xmlResponse ).map(function() {
                return {
                    title: $( "title", this ).text(),
                    content: $("content",this).text(),
                    url: $( "url" , this).text()
                };
            }).get();
            var $input = document.getElementById(search_id);
            var $resultContent = document.getElementById(content_id);
            $input.addEventListener('input', function(){
                var matchcounts = 0;
                var str='<ul class=\"search-result-list\">';                
                var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                $resultContent.innerHTML = "";
                if (this.value.trim().length > 1) {
                // perform local searching
                datas.forEach(function(data) {
                    var isMatch = true;
                    var content_index = [];
                    var data_title = data.title.trim().toLowerCase();
                    var data_content = data.content.trim().replace(/<[^>]+>/g,"").toLowerCase();
                    var data_url = data.url;
                    var index_title = -1;
                    var index_content = -1;
                    var first_occur = -1;
                    // only match artiles with not empty titles and contents
                    if(data_title != '' && data_content != '') {
                        keywords.forEach(function(keyword, i) {
                            index_title = data_title.indexOf(keyword);
                            index_content = data_content.indexOf(keyword);
                            if( index_title < 0 && index_content < 0 ){
                                isMatch = false;
                            } else {
                                if (index_content < 0) {
                                    index_content = 0;
                                }
                                if (i == 0) {
                                    first_occur = index_content;
                                }
                            }
                        });
                    }
                    // show search results
                    if (isMatch) {
                        matchcounts += 1;
                        str += "<li><a href='"+ data_url +"' class='search-result-title'>"+ data_title +"</a>";
                        var content = data.content.trim().replace(/<[^>]+>/g,"");
                        if (first_occur >= 0) {
                            // cut out 100 characters
                            var start = first_occur - 20;
                            var end = first_occur + 80;
                            if(start < 0){
                                start = 0;
                            }
                            if(start == 0){
                                end = 50;
                            }
                            if(end > content.length){
                                end = content.length;
                            }
                            var match_content = content.substring(start, end);
                            // highlight all keywords
                            keywords.forEach(function(keyword){
                                var regS = new RegExp(keyword, "gi");
                                match_content = match_content.replace(regS, "<b class=\"search-keyword\">"+keyword+"</b>");
                            });
                            
                            str += "<p class=\"search-result\">" + match_content +"...</p>"
                        }
                        str += "</li>";
                    }
                })};
                str += "</ul>";
                if (matchcounts == 0) { str = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>' }
                if (keywords == "") { str = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>' }
                $resultContent.innerHTML = str;
            });
            proceedsearch();
        }
    });}

    // handle and trigger popup window;
    $('.popup-trigger').mousedown(function(e) {
      e.stopPropagation();
      if (isfetched == false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };

    });

    $('.popup-btn-close').click(function(e){
      $('.popup').hide();
      $(".popoverlay").remove();
      $('body').css('overflow', '');
    });
    $('.popup').click(function(e){
      e.stopPropagation();
    });
  </script>

  
  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
    });
  </script>

  <script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
      var all = MathJax.Hub.getAllJax(), i;
      for (i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';
      }
    });
  </script>
  <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>


  

  
  <script src="https://chocoluffy.com/toolbox/hexo/av-core-mini-0.6.1.js"></script>
  <script>AV.initialize("8bVuIF2Vk3EPyqe2OmRaXdgu-gzGzoHsz", "nvwBdADmn3ifRtefzQNGADue");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            counter.save(null, {
              success: function(counter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.get('time'));
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            var newcounter = new Counter();
            /* Set ACL */
            var acl = new AV.ACL();
            acl.setPublicReadAccess(true);
            acl.setPublicWriteAccess(true);
            newcounter.setACL(acl);
            /* End Set ACL */
            newcounter.set("title", title);
            newcounter.set("url", url);
            newcounter.set("time", 1);
            newcounter.save(null, {
              success: function(newcounter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
              },
              error: function(newcounter, error) {
                console.log('Failed to create');
              }
            });
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script>



  

</body>
</html>
